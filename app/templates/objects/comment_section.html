{% load humanize %}


<div class="panel panel-default comments">
    <div class="panel-heading panel-heading-title">
        Your ratings
    </div>
    <div class="panel-body">
        {% include 'objects/your_ratings.html' %}
    </div>
</div>

<div class="panel panel-default comments">
    <div class="panel-heading panel-heading-title">
        Reviews
    </div>
    <div class="panel-body">
        {% if user_auth %}
            <form role="form" action="{% url 'submit_comment' %}" method="post">
                <input type="hidden" name="url" value="{% url 'course_page' course.slug %}">
                <input type="hidden" name="course_id" value="{{course.id}}">
                {% csrf_token %}
                <div class="row">
                    <div class="col-md-9">
                        <textarea class="form-control comment-submit" rows="2" max-length="1000" placeholder="Write a review..." name="comment"></textarea>
                    </div>
                    <div class="col-md-3">
                        <button type="submit" class="btn btn-default">Submit</button>
                        <div class="checkbox">
                            <small> <input type="checkbox" name="anonymous" value="true" checked> Anonymous </small>
                        </div>
                    </div>
                </div>
            </form>
        {% else %}
            <div class="auth-to-rate">
                To submit a review please log in!
            </div>
        {% endif %}


        <div class="comments-display">
            {% for comment in comments reversed %}
                <hr>
                <div class="row">
                    <div class="text-muted col-md-4"> @{{ comment.comment.id }} </div>
                    <div class="text-muted col-md-4"> {% if comment.posted_by %} by {{ comment.posted_by }} {% endif %} </div>
                    <div class="text-muted col-md-4">
                        <div class="comment-datetime">
                            {{ comment.comment.datetime|naturaltime }}
                        </div>
                    </div>
                </div>

                <div class="comment-text" align="justify">
                    {{ comment.comment.comment|linebreaks }}
                </div>

                <div class="comment-rate">
                    <div class="rate-content">
                        <small> Helpful? 

                            <form class="comment-rate-form" role="form" action="{% url 'submit_comment_upvote' %}" method="post">
                                <input type="hidden" name="comment_id" value="{{comment.comment.id}}">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-default btn-xs">Yes</button>
                            </form>

                            <form class="comment-rate-form" role="form" action="{% url 'submit_comment_downvote' %}" method="post">
                                <input type="hidden" name="comment_id" value="{{comment.comment.id}}">
                                {% csrf_token %}
                                <button type="submit" class="btn btn-default btn-xs">No</button>
                            </form>

                        </small>
                    </div>
                </div>
            {% endfor %}
        </div>
    </div>
</div>